<h1><%= @event.name %></h1>

<section>
  <h2>Upload Files to This Event</h2>
  <%= form_for @upload, url: event_uploads_path(@event), html: { multipart: true } do |f| %>
    <div class="form-group">
      <%= f.label :file, "Upload File (Text, Image, Video)" %>
      <%= f.file_field :file, class: "form-control" %>
    </div>
    <div class="form-group">
      <%= f.submit 'Upload File', class: 'button' %>
    </div>
  <% end %>
</section>

<section>
  <h2>Uploads for <%= @event.name %></h2>
  <% if @event.uploads.any? %>
    <div class="uploads-grid">
      <% @event.uploads.each do |upload| %>
        <div class="card">
          <div class="card-image">
            <% if upload.mediaType.present? && upload.mediaType.include?("image") %>
              <%= image_tag upload.mediaUrl if upload.mediaUrl.present? %>
            <% elsif upload.mediaType.present? && upload.mediaType.include?("video") %>
              <video controls>
                <source src="<%= upload.mediaUrl %>" type="<%= upload.mediaType %>">
                Your browser does not support the video tag.
              </video>
            <% else %>
              <p>File cannot be previewed.</p>
            <% end %>
          </div>
          <div class="card-content">
            <% if upload.persisted? %>
              <h3><%= link_to "View Upload", event_upload_path(@event, upload) %></h3>
            <% else %>
              <p>File has not been saved yet.</p>
            <% end %>
            <p>Uploaded on: <%= upload.created_at.strftime("%B %d, %Y") if upload.created_at %></p>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p>No uploads yet.</p>
  <% end %>
</section>

<section>
  <%= link_to 'Back to Events', events_path, class: 'button' %>

  <%= form_for @event, url: event_path(@event), method: :delete, data: { confirm: 'Are you sure you want to delete this event?' }, class: 'delete-form' do %>
    <%= submit_tag 'Delete Event', class: 'button delete-button' %>
  <% end %>
</section>
