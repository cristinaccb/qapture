<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= @event.name %> - Event Details - Qapture</title>
</head>
<body>
  <h1><%= @event.name %></h1>
  <p><%= @event.description %></p>

  <h2>Share This Event</h2>
  <div id="qr-code-container">
    <!-- Initially display QR code or placeholder if not yet generated -->
    <% if @event.qr_code.present? %>
      <%= raw @event.qr_code.qr_code_data %>
    <% else %>
      <p>No QR code generated yet.</p>
    <% end %>
  </div>
  <button onclick="createOrUpdateQR()">Generate QR Code</button>

  <script>
    function createOrUpdateQR() {
      fetch('<%= event_qr_code_path(@event) %>', { method: 'GET' })
        .then(response => response.json())
        .then(data => {
          document.getElementById('qr-code-container').innerHTML = data.qr_code;
        })
        .catch(error => console.error('Error generating QR code:', error));
    }
  </script>
</body>
</html>
